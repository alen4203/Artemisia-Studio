(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{8583:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return a(7091)}])},3170:function(e,t,a){"use strict";a.d(t,{Z:function(){return E},C:function(){return _}});var i,o,r=a(1527),n=a(959);(i=o||(o={})).ADD_TO_CART="ADD_TO_CART",i.REMOVE_FROM_CART="REMOVE_FROM_CART",i.UPDATE_QUANTITY="UPDATE_QUANTITY",i.APPLY_COUPON="APPLY_COUPON",i.REMOVE_COUPON="REMOVE_COUPON",i.LOAD_CART="LOAD_CART";var c=a(2377);let u=[{code:"SAVE20",type:c.$.PERCENTAGE,value:20,maxDiscount:100,description:"20% off your order (max discount $100)",isActive:!0},{code:"WELCOME50",type:c.$.FIXED_AMOUNT,value:50,minPurchase:200,description:"$50 off on orders over $200",isActive:!0},{code:"FREESHIP",type:c.$.FREE_SHIPPING,value:0,description:"Free shipping on your order",isActive:!0},{code:"SUMMER10",type:c.$.PERCENTAGE,value:10,description:"10% off your entire order",isActive:!0},{code:"FIRST100",type:c.$.FIXED_AMOUNT,value:100,minPurchase:500,description:"$100 off on orders over $500",isActive:!0},{code:"EXPIRED",type:c.$.PERCENTAGE,value:50,description:"Expired coupon",expiryDate:new Date("2023-01-01"),isActive:!0}],s=e=>u.find(t=>t.code.toUpperCase()===e.toUpperCase());var p=a(1392);let d="candle-store-cart",l=(0,n.createContext)({}),E=e=>{let{children:t}=e,a=(e,t)=>{var a,i,r;let n,u;switch(t.type){case o.ADD_TO_CART:let s=e.cart.find(e=>e.id===t.payload.id);u=s?e.cart.map(e=>e.id===t.payload.id?{...e,quantity:e.quantity+t.payload.quantity}:e):[...e.cart,t.payload];let d=(0,p.zX)(u),l=(0,p.Et)(e.appliedCoupon,d),E=(0,p.Rr)(d,(null===(a=e.appliedCoupon)||void 0===a?void 0:a.type)===c.$.FREE_SHIPPING);n={...e,cart:u,totalItems:u.reduce((e,t)=>e+t.quantity,0),totalPrice:d,discountAmount:l,shippingFee:E};break;case o.REMOVE_FROM_CART:let _=e.cart.filter(e=>e.id!==t.payload.id),A=(0,p.zX)(_),P=(0,p.Et)(e.appliedCoupon,A),f=(0,p.Rr)(A,(null===(i=e.appliedCoupon)||void 0===i?void 0:i.type)===c.$.FREE_SHIPPING);n={...e,cart:_,totalItems:_.reduce((e,t)=>e+t.quantity,0),totalPrice:A,discountAmount:P,shippingFee:f};break;case o.UPDATE_QUANTITY:let y=e.cart.map(e=>e.id===t.payload.id?t.payload:e),R=(0,p.zX)(y),C=(0,p.Et)(e.appliedCoupon,R),O=(0,p.Rr)(R,(null===(r=e.appliedCoupon)||void 0===r?void 0:r.type)===c.$.FREE_SHIPPING);n={...e,cart:y,totalItems:y.reduce((e,t)=>e+t.quantity,0),totalPrice:R,discountAmount:C,shippingFee:O};break;case o.APPLY_COUPON:let T=t.payload,m=(0,p.zX)(e.cart),v=(0,p.Et)(T,m),I=(0,p.Rr)(m,T.type===c.$.FREE_SHIPPING);n={...e,appliedCoupon:T,discountAmount:v,shippingFee:I};break;case o.REMOVE_COUPON:let N=(0,p.zX)(e.cart),D=(0,p.Rr)(N,!1);n={...e,appliedCoupon:null,discountAmount:0,shippingFee:D};break;case o.LOAD_CART:n=t.payload;break;default:n=e}return n},[i,u]=(0,n.useReducer)(a,{cart:[],totalItems:0,totalPrice:0,appliedCoupon:null,discountAmount:0,shippingFee:30});(0,n.useEffect)(()=>{let e=localStorage.getItem(d);if(e)try{let t=JSON.parse(e);u({type:o.LOAD_CART,payload:t})}catch(e){console.error("Failed to load cart from localStorage:",e)}},[]),(0,n.useEffect)(()=>{i.cart.length>0||i.appliedCoupon?localStorage.setItem(d,JSON.stringify(i)):localStorage.removeItem(d)},[i]);let E=e=>i.cart.find(t=>t.id===e),_=e=>{let t=s(e);if(!t)return{success:!1,message:"Invalid coupon code"};let a=(0,p.zX)(i.cart),r=(0,p.hD)(t,a);return r.isValid?(u({type:o.APPLY_COUPON,payload:t}),{success:!0,message:"".concat(t.description)}):{success:!1,message:r.message}},A=()=>{u({type:o.REMOVE_COUPON})};return(0,r.jsx)(l.Provider,{value:{cartState:i,addItem:e=>u({type:o.ADD_TO_CART,payload:e}),removeItem:e=>u({type:o.REMOVE_FROM_CART,payload:e}),updateQuantity:e=>u({type:o.UPDATE_QUANTITY,payload:e}),getItemInfoFromCart:E,applyCoupon:_,removeCoupon:A},children:t})};var _=l},7091:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return r}});var i=a(1527);a(2798);var o=a(3170);function r(e){let{Component:t,pageProps:a}=e;return(0,i.jsxs)(o.Z,{children:[(0,i.jsx)(t,{...a}),";"]})}},2377:function(e,t,a){"use strict";var i,o;a.d(t,{$:function(){return i}}),(o=i||(i={})).PERCENTAGE="PERCENTAGE",o.FIXED_AMOUNT="FIXED_AMOUNT",o.FREE_SHIPPING="FREE_SHIPPING"},1392:function(e,t,a){"use strict";a.d(t,{Et:function(){return c},Rr:function(){return r},T4:function(){return s},hD:function(){return n},tf:function(){return u},zX:function(){return o}});var i=a(2377);let o=e=>e.reduce((e,t)=>e+t.price*t.quantity,0),r=(e,t)=>t||e>=500?0:30,n=(e,t)=>e.isActive?e.expiryDate&&new Date>new Date(e.expiryDate)?{isValid:!1,message:"This coupon has expired"}:e.minPurchase&&t<e.minPurchase?{isValid:!1,message:"Minimum purchase of $".concat(e.minPurchase," required")}:{isValid:!0,message:"Coupon applied successfully!"}:{isValid:!1,message:"This coupon is not active"},c=(e,t)=>{if(!e)return 0;switch(e.type){case i.$.PERCENTAGE:let a=t*e.value/100;if(e.maxDiscount)return Math.min(a,e.maxDiscount);return a;case i.$.FIXED_AMOUNT:return Math.min(e.value,t);case i.$.FREE_SHIPPING:default:return 0}},u=(e,t,a)=>Math.max(0,e-t+a),s=e=>"$".concat(e.toFixed(2))},2798:function(){}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[774,179],function(){return t(8583),t(9426)}),_N_E=e.O()}]);